<h2> <%= @league.name %> </h2><br>

<% if is_admin? %>
  <h5><%= link_to "Edit League Info", edit_league_path(@league) %></h5>
  <br>
<% end %>


<h4> League Standings </h4>
<table style='width:50%'>
  <tr>
    <th>Position</th>
    <th>Team Name</th>
    <th>Points</th>
    <th>User</th>
  </tr>

  <% @teams.each_with_index do |team, i| %>
  <tr id="team_profile" team_id="<%= team.id %>">
    <td><%= i + 1 %></td>
    <td><a href='#' onclick="loadTeam('<%=team.id')"><%= team.name %></td>
    <td><%= team.points_total %></td>
    <td><%= team.user.name %></td>
    </tr>
    <% end %>
  </table>
  <br>

<div id="messageBoard">
  <h4><a href='#' onclick='viewMessageBoard()'>Message Board</a></h4>
  <br>
  <div id="newMessageForm"></div>
</div>

<script type="text/javascript" charset="utf-8">
function viewMessageBoard() {
  event.preventDefault();
  $('#messageBoard').html("<%= j (render 'comments/index') %>")
}
</script>

<script id="team-template" type="text/x-handlebars-template">
    <h1>{{name}}</h1><br>
    <h3>{{position}}</h3><br>

    <h4>Salary: ${{salary}}</h4><br>
    <h4>Points: ${{points}}</h4><br>

    <h4>Stats</h4><br>
      <p>TDs: {{touchdowns}}</p><br>
      <p>Passing Yards: {{pass_yards}}</p><br>
      <p>Rushing Yards: {{rush_yards}}</p><br>
      <p>Receptions: {{receptions}}</p><br>
      <p>Receiving Yards: {{rec_yards}}</p><br>
</script>

<script type="text/javascript" charset="utf-8">
function loadTeam(team_id) {
    event.preventDefault()
    var url = '/players/' + player_id
    $.getJSON(url, function(data) {
      var player = {
        name: data.data.attributes.name,
        position: data.data.attributes.position.name,
        salary: data.data.attributes.salary,
        points: data.data.attributes.points,
        touchdowns: data.data.attributes.touchdowns,
        pass_yards: data.data.attributes["pass-yards"],
        rush_yards: data.data.attributes["rush-yards"],
        receptions: data.data.attributes.receptions,
        rec_yards: data.data.attributes["rec-yards"]
      }
      var template = Handlebars.compile(document.getElementById("player-template").innerHTML)
      var result = template(player)
      var element = Array.from($('#playerid-' + data.data.id))
      debugger
      element[0].innerHTML = result
    })
    return false
  }
</script>
